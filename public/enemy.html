<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Your Own Worst Enemy - Tetris Heaven</title>
		<link rel="icon" type="image/gif" href="images/animated_favicon1.gif">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
		<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
		<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
		<link rel="stylesheet" type="text/css" href="styles/main.css">
	</head>

	<body>
		<script type="text/javascript" src="includes/navbar.js"></script>

		<div class="container" >
			<div class="jumbotron" style="  padding-right: 0px; padding-left: 0px">
				<h1 class="text-center">Meet Your Worst Enemy: <strong>YOU</strong></h1>
				<div class="center-block" align="center" style="margin-top: 50px">
					<h3 class="text-center">Control two different boards at once! Make sure you don't lose track of the other.</h3>

					<table align="center">
						<tr>
							<input type="button" class="btn-lg btn-primary" id="play_button" align="center" value="Play now!" style="margin-bottom: 30px"/>
							<input type="button" class="btn-lg btn-primary" id="play_button_again" align="center" value="Play again!" style="margin-bottom: 30px"/>
						</tr>
					</table>
				
					<div class="row" style="background-color: #000; border-radius:10px">
						<div class="col-md-6" style="padding-left:0; padding-right:10">
							<div class="jumbotron" id="gameHolder" style="background-color: #000;  padding-right: 0px; padding-left: 0px">
								<div class="game" id="tetris-demo" align="center"></div>
							</div>
						</div>
						<div class="col-md-6" style="padding-left:10; padding-right:0">
							<div class="jumbotron" id="gameHolder" style="background-color: #000;  padding-right: 0px; padding-left: 0px">
								<div class="game" id="tetris-demo" align="center"></div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<script src="./blockrain/jquery-1.11.1.min.js"></script>
		<script src="./blockrain/blockrain.jquery.libs.js"></script>
		<script src="./blockrain/blockrain.jquery.src.js"></script>
		<script src="./blockrain/blockrain.jquery.themes.js"></script>
		<script>
$(document).ready(function(){
	var ended = false;
	$("#play_button_again").hide();
});
var $game = $('.game').blockrain({
	speed: 20,
	theme: 'ours1',
	IsDouble: true,
	onStart: function() {
		console.log("starting");
		if ($('.blockrain-score-holder2')[0] != undefined) {
			
		} else {
			$('.row').after( '<div class="blockrain-score-holder2" style="position:absolute; left: ' + ($('.row').offset().left+$('.row').width()/2 - 64) + 'px; top: '+($('.row').offset().top+600)+'px;">'+
				  '<img src="images/blankslide.png">' + 
				  '<h2 div class="blockrain-score" style="position:absolute; left:25px; top:0px; color:#c2ffad;">'+
					'<div class="blockrain-score-msg">'+ 'Score' +'</div>'+
					'<div class="blockrain-score-num">0</div>'+
				  '</div>'+
			'</div>');
			$('.row').after( '<div class="blockrain-game-over-holder" style="position:absolute; left: ' + ($('.row').offset().left+$('.row').width()/2 - 100) + 'px; top: '+($('.row').offset().top+100)+'px;">'+
			  '<img src="images/gameover.png">' + 
			'</div>');
		}
		$(".blockrain-game-over-holder").hide();
		$("#play_button").hide();
		$("#play_button_again").hide();
		$('html, body').animate({
			scrollTop: $('.game').offset().top - 55
		}, 'slow');
		
		/*$('.row').after( '<div class="blockrain-score-holde2" style="position:absolute; left: ' + ($('.row').offset().left+$('.row').width()/2 - 37) + 'px; top: '+($('.row').offset().top+500)+'px;">'+
			  '<h2 div class="blockrain-score" style="position:relative; left:0px; top:60px; color:#c2ffad;">'+
            '<div class="blockrain-score-msg">'+ 'Score' +'</div>'+
            '<div class="blockrain-score-num">0</div>'+
          '</div>'+
        '</div>');
		$('.row').after( '<div class="blockrain-game-over-holder" style="position:absolute; left: ' + ($('.row').offset().left+$('.row').width()/2 - 100) + 'px; top: '+($('.row').offset().top+100)+'px;">'+
          '<img src="images/gameover.png">' + 
        '</div>');
		$(".blockrain-game-over-holder").hide();*/



		
	},
	onLine: function() {
		//
	},
	onGameOver: function(score){
			
			$(".game").blockrain("gameover");
			$("#play_button_again").show();
			$("#play_button").attr('disabled', true);
			$("#play_button").hide();
			$(".blockrain-game-over-holder").show();
			
			var score = parseInt($('.blockrain-score-num').text());
			
			$.ajax({
						type: 'POST',
						data: score,
						dataType: 'json',
						contentType: "application/x-www-form-urlencoded",
						url: 'http://localhost:6001/recovery/board',
						success: function(data) {
							console.log(data);
						},
						error: function(XMLHttpRequest, textStatus, errorThrown) {
							console.log("error sending post");
						}
				   }
			);
			
		
	}
});

$('#play_button').click(function(event){
	event.preventDefault();

	$('.game').blockrain('start');
});
$('#play_button_again').click(function(event){
	event.preventDefault();

	$('.game').blockrain('start');
});

				</script>
			</div>
		</div>
	</body>
</html>
